# 导出/导入功能使用说明

## 功能概述

现在您可以导出和导入所有笔记数据，实现数据备份、迁移和恢复。

## 导出功能

### 如何导出

1. 在左侧边栏底部找到 **"DATA"** 区域
2. 点击紫色的 **"Export"** 按钮
3. 浏览器会自动下载一个 JSON 文件
4. 文件名格式：`little-prince-journal-2026-02-05.json`

### 导出内容

导出的 JSON 文件包含：
- ✅ 所有笔记本信息
- ✅ 所有章节数据
- ✅ 所有页面内容
- ✅ 所有组件（便签、图片、箭头、文字框）
- ✅ 组件的位置、大小、旋转角度
- ✅ 导出日期和版本信息

### 数据格式

```json
{
  "version": "1.0",
  "exportDate": "2026-02-05T10:30:00Z",
  "appName": "Little Prince Journal",
  "notebooks": [...],
  "chapters": {...},
  "pages": {...},
  "annotations": {...}
}
```

## 导入功能

### 如何导入

1. 在左侧边栏底部找到 **"DATA"** 区域
2. 点击橙色的 **"Import"** 按钮
3. 选择之前导出的 JSON 文件
4. 确认导入信息
5. 点击"确定"完成导入
6. 页面会自动刷新

### ⚠️ 重要提示

**导入会替换所有现有数据！**

- 导入前会显示确认对话框
- 显示导出日期和笔记本数量
- 确认后会删除当前所有数据
- 然后导入新数据
- 最后自动刷新页面

### 导入流程

```
选择文件 → 验证格式 → 显示确认 → 替换数据 → 刷新页面
```

## 使用场景

### 1. 定期备份

**建议频率**：每周一次

```
步骤：
1. 点击 Export 按钮
2. 保存到安全位置（云盘、U盘）
3. 重命名文件（如：backup-2026-02-05.json）
```

### 2. 更换设备

**从旧设备迁移到新设备**

```
旧设备：
1. 导出数据
2. 通过邮件/云盘传输文件

新设备：
1. 打开应用
2. 导入数据文件
3. 开始使用
```

### 3. 数据恢复

**误删除或数据丢失**

```
步骤：
1. 找到最近的备份文件
2. 点击 Import 按钮
3. 选择备份文件
4. 确认导入
```

### 4. 多人协作

**分享笔记给他人**

```
发送方：
1. 导出数据
2. 发送 JSON 文件

接收方：
1. 导入数据
2. 查看/编辑笔记
3. 导出后发回
```

### 5. 版本管理

**保留不同版本**

```
命名规范：
- journal-v1-2026-02-01.json
- journal-v2-2026-02-05.json
- journal-final-2026-02-10.json
```

## 数据安全

### 备份策略

#### 3-2-1 备份原则

- **3** 份副本：原始数据 + 2 份备份
- **2** 种介质：本地硬盘 + 云存储
- **1** 份异地：云盘或远程服务器

#### 推荐方案

```
每天：导出到本地文件夹
每周：上传到云盘（Google Drive/OneDrive）
每月：下载到U盘保存
```

### 文件管理

#### 文件命名

```
格式：journal-[描述]-[日期].json

示例：
- journal-backup-2026-02-05.json
- journal-before-cleanup-2026-02-05.json
- journal-project-complete-2026-02-05.json
```

#### 文件夹结构

```
Documents/
└── LittlePrinceJournal/
    ├── Backups/
    │   ├── 2026-02/
    │   │   ├── journal-2026-02-01.json
    │   │   ├── journal-2026-02-05.json
    │   │   └── journal-2026-02-10.json
    │   └── 2026-03/
    └── Archive/
        └── journal-2025-12-31.json
```

### 数据加密（可选）

如果需要保护隐私：

1. **使用压缩软件加密**
   - 7-Zip：添加密码保护
   - WinRAR：AES-256 加密

2. **使用加密工具**
   - VeraCrypt：创建加密容器
   - BitLocker：Windows 内置加密

## 故障排除

### 导出失败

**问题**：点击 Export 没有反应

**解决方案**：
1. 检查浏览器控制台（F12）
2. 确认浏览器支持下载功能
3. 检查浏览器下载设置
4. 尝试其他浏览器

### 导入失败

**问题**：导入时提示错误

**可能原因**：
1. ❌ 文件格式错误
2. ❌ 文件损坏
3. ❌ 版本不兼容
4. ❌ 文件不完整

**解决方案**：
1. 确认文件是 JSON 格式
2. 用文本编辑器打开检查
3. 尝试其他备份文件
4. 重新导出数据

### 数据丢失

**问题**：导入后数据不完整

**检查项**：
1. 查看导出文件大小
2. 对比笔记本数量
3. 检查章节和页面
4. 验证组件是否存在

**预防措施**：
1. 导入前先导出当前数据
2. 保留多个备份版本
3. 定期验证备份文件

## 高级功能（计划中）

### 选择性导出

```javascript
// 导出单个笔记本
App.exportNotebook(notebookId)

// 导出单个章节
App.exportChapter(notebookId, chapterId)

// 导出单个页面
App.exportPage(chapterId, pageIndex)
```

### 增量备份

```javascript
// 只导出修改过的数据
App.exportChanges(since: Date)
```

### 自动备份

```javascript
// 每天自动导出
App.enableAutoBackup({
    frequency: 'daily',
    time: '23:00',
    location: 'downloads'
})
```

### 云端同步

```javascript
// 同步到云端
App.syncToCloud({
    provider: 'google-drive',
    autoSync: true
})
```

## 常见问题

### Q: 导出文件可以编辑吗？
A: 可以，但不建议。JSON 格式对语法要求严格，手动编辑容易出错。

### Q: 可以合并多个导出文件吗？
A: 当前版本不支持。计划在未来版本添加合并功能。

### Q: 导出文件有大小限制吗？
A: 理论上无限制，但受 localStorage 容量限制（5-10MB）。

### Q: 可以导出为其他格式吗？
A: 当前只支持 JSON。HTML 和 PDF 导出在计划中。

### Q: 导入会保留原有数据吗？
A: 不会。导入会完全替换现有数据。建议先导出备份。

### Q: 可以定时自动导出吗？
A: 当前版本不支持。自动备份功能在计划中。

## 最佳实践

### 1. 养成备份习惯
- 每次重要编辑后导出
- 每周定期备份
- 重要项目完成后立即备份

### 2. 多地备份
- 本地电脑
- 云存储
- 移动硬盘

### 3. 验证备份
- 定期测试导入功能
- 确认数据完整性
- 检查文件是否损坏

### 4. 版本管理
- 保留多个版本
- 使用有意义的文件名
- 定期清理旧备份

### 5. 安全存储
- 敏感内容加密
- 不要分享到公共平台
- 定期更新备份

## 技术细节

### 数据结构

```javascript
{
  version: "1.0",              // 格式版本
  exportDate: "ISO 8601",      // 导出时间
  appName: "string",           // 应用名称
  notebooks: Array,            // 笔记本列表
  chapters: Object,            // 章节数据（按笔记本ID索引）
  pages: Object,               // 页面内容（按键名索引）
  annotations: Object          // 组件数据（按键名索引）
}
```

### 兼容性

- ✅ Chrome 90+
- ✅ Firefox 88+
- ✅ Edge 90+
- ✅ Safari 14+
- ❌ IE 11

### 性能

- 导出速度：~100ms（1000页）
- 导入速度：~200ms（1000页）
- 文件大小：~1KB/页（纯文本）
- 文件大小：~100KB/页（含图片）

## 更新日志

### v1.2.0 (2026-02-05)
- ✅ 添加 JSON 导出功能
- ✅ 添加 JSON 导入功能
- ✅ 数据完整性验证
- ✅ 导入前确认对话框

### 计划功能 (v1.3.0)
- ⏳ HTML 格式导出
- ⏳ PDF 格式导出
- ⏳ 选择性导出
- ⏳ 自动备份
- ⏳ 云端同步

## 技术支持

如有问题，请查看：
- `导出功能设计方案.md` - 完整设计文档
- `功能说明.md` - 应用功能说明
- 浏览器开发者工具 Console - 查看错误日志
